<div class="container" ng-cloak>

  <p class="title-page">Add recipe</p>

  <br />
  <p class="sub-title-page">Identity</p>
  <div class="row" ng-cloak>
    <div class="col-md-3">
      <div class="ratio-container" id="containerPreviewImage">
        <div class="ratio-4_3 background-image" id="previewImage" ng-click="simulateClickFile();" ng-style="{'background-image': 'url(/images/default-preview.png)'}"></div>
      </div>
      <input class="hidden" id="uploadImage" type="file" file-model="photoRecipe"/>
    </div>

    <div class="col-md-8 col-md-offset-1">
      <div class="form-group">
        <label class="form-label" for="nameIngredient">Recipe name</label>
        <input type="text" ng-class="{'input-text-error': submitted && emptyRecipeName}" class="form-control input-text" ng-model="nameRecipe" name="nameRecipe" id="nameRecipe" placeholder="Recipe name" ng-change="emptyRecipeName = false;">
        <div class="block-error" ng-show="submitted && emptyRecipeName">The recipe name is required and cannot be empty.</div>
      </div>

      <div class="row">
        <div class="col-xs-12 form-group">
          <label class="form-label">Recipe category</label><br />
          <div data-ng-repeat="(k, v) in recipe_categories_mapper track by $index" ng-style="$index == 0 && {'background-color': v.color}" ng-click="changeCategory($event, k)" class="col-sm-2 col-xs-4 categories">
            {{ v.name }}
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-4 form group">
          <label class="form-label">Servings</label><br />
          <div class="input-group">
            <input type="number" class="form-control input-text" ng-model="servingsRecipe" name="servingsRecipe" id="servingsRecipe" min="1">
            <div class="input-group-addon input-text" ng-if="servingsRecipe <= 1">&nbsp;Person&nbsp;</div>
            <div class="input-group-addon input-text" ng-if="servingsRecipe > 1">Persons</div>
          </div>
        </div>

        <div class="col-xs-4 form group">
          <label class="form-label">Preparation Time</label><br />
          <div class="input-group">
            <input type="number" class="add-recipe-time-value form-control input-text" ng-model="prepTimeValueRecipe" name="prepTimeValueRecipe" id="prepTimeValueRecipe" min="0">
            <select ng-options="i for i in timeList" name="prepTimeUnitRecipe" ng-model="prepTimeUnitRecipe" class="add-recipe-time-unit form-control"></select>
          </div>
        </div>

        <div class="col-xs-4 form group">
          <label class="form-label">Cooking Time</label><br />
          <div class="input-group">
            <input type="number" class="add-recipe-time-value form-control input-text" ng-model="cookTimeValueRecipe" name="cookTimeValueRecipe" id="cookTimeValueRecipe" min="0">
            <select ng-options="i for i in timeList" name="cookTimeUnitRecipe" ng-model="cookTimeUnitRecipe" class="add-recipe-time-unit form-control"></select>
          </div>
        </div>
      </div>

    </div>
  </div>

  <br />
  <p class="sub-title-page">Description</p>
  <div class="row">
    <div class="col-xs-12 form-group">
      <textarea class="form-control input-text" rows="3" ng-model="descriptionRecipe" name="descriptionRecipe" id="descriptionRecipe" style="max-width: 100%;"></textarea>
    </div>
  </div>

  <br />
  <p class="sub-title-page">Ingredients</p>
  <div class="row">
    <div class="col-xs-12 form-group">
      <label class="form-label" for="ingredients">Search ingredients</label>
      <angucomplete-alt id="ingredients"
      placeholder="Search ingredients"
      pause="400"
      minlength="1"
      match-class="highlight"
      selected-object="addIngredientToRecipe"
      remote-url="http://nourriture.dennajort.fr/api/ingredient/autocomplete?{{urlIngredientExclude}}name="
      remote-url-data-field=""
      title-field="name"
      description-field="category"
      image-field="photo_url"
      template-url="/my-custom-template.html"
      input-class="form-control input-text"/>
    </div>
    <div class="col-xs-12">
      <p class="main-color" ng-show="recipeIngredients.length == 0">No ingredient defined for this new recipe</p>
      <div class="row">
        <div class="col-xs-12">
        <ul class="recipe-add-ingredient-ul">
          <li class="col-lg-2 col-md-3 col-sm-6" ng-repeat="ingredient in recipeIngredients">
            <div class="ratio-container">
              <div class="ratio-4_3 background-image" style="background-size: 90%" ng-style="{'background-image': 'url({{ ingredient.photo_url }})'}"></div>
            </div>
            <div class="col-xs-12 recipe-add-ingredient-content">
              <div>
                {{ ingredient.name }} <i class="mdi-navigation-close recipe-remove-ingredient-btn" ng-click="removeIngredientFromRecipe($index)"></i>
              </div>
              <div class="recipe-add-ingredient-container">
                <a href="#" buttons="no" editable-text="ingredient.quantity" onbeforesave="checkQuantity($data)">
                  {{ ingredient.quantity || 'empty' }}
                </a>
              </div>
            </div>
          </li>
        </ul>
        </div>
      </div>
    </div>
  </div>



  <!-- Ingredients list -->
<!--
  <p class="sub-title">Ingredients list</p>
  <div class="row">
    <div class="col s12 m12 l12">
      <div>
        <angucomplete-alt id="ingredients"
        placeholder="Search ingredients"
        pause="400"
        minlength="1"
        match-class="highlight"
        selected-object="addIngredientToRecipe"
        remote-url="http://nourriture.dennajort.fr/api/ingredient/autocomplete?{{urlIngredientExclude}}name="
        remote-url-data-field=""
        title-field="name"
        description-field="category"
        image-field="photo_url"
        template-url="/my-custom-template.html"
        input-class="form-control form-control-small"/>
      </div>
      <p ng-show="recipeIngredients.length == 0">No ingredient defined for this new recipe</p>
      <ul class="row ul-recipe-add-ingredient">
        <li class="col s6 m3 l2" ng-repeat="ingredient in recipeIngredients">
            <div class="ratio-container">
              <div class="ratio-4_3 background-image" style="background-size: 90%" ng-style="{'background-image': 'url({{ ingredient.photo_url }})'}"></div>
            </div>
            <div class="li-recipe-add-ingredient-content">
              <div>
                {{ ingredient.name }} <i class="mdi-navigation-close recipe-remove-ingredient-btn" ng-click="removeIngredientFromRecipe($index)"></i>
              </div>
              <div>
                <a href="#" buttons="no" editable-text="ingredient.quantity" onbeforesave="checkQuantity($data)">
                  {{ ingredient.quantity || 'empty' }}
                </a>
              </div>
            </div>
        </li>
      </ul>
    </div>
  </div>
  {{ recipeIngredients }}


  {{ idIngredientExclude }}
  {{ urlIngredientExclude }}
  <script type="text/ng-template" id="/my-custom-template.html">

  <div class="angucomplete-holder" ng-class="{'angucomplete-dropdown-visible': showDropdown}">
    <input ng-model="searchStr"
    ng-disabled="disableInput"
    type="text"
    placeholder="{{placeholder}}"
    ng-focus="onFocusHandler()"
    class="{{inputClass}}"
    ng-focus="resetHideResults()"
    ng-blur="hideResults($event)"
    autocapitalize="off"
    autocorrect="off"
    autocomplete="off"
    ng-change="inputChangeHandler(searchStr);"/>
    <div class="angucomplete-dropdown" ng-show="showDropdown">
      <div class="angucomplete-searching" ng-show="searching" ng-bind="textSearching"></div>
      <div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults"></div>
      <div class="angucomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{'angucomplete-selected-row': $index == currentIndex}">
        <div ng-if="imageField" class="angucomplete-image-holder">
          <img ng-if="result.image && result.image != ''" ng-src="{{result.image}}" class="angucomplete-image"/>
          <div ng-if="!result.image && result.image != ''" class="angucomplete-image-default"></div>
        </div>
        <div class="angucomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div>
        <div class="angucomplete-title" ng-if="!matchClass">{{ result.title }}</div>
        <div ng-if="matchClass && result.description && result.description != ''" class="angucomplete-description" ng-bind-html="result.description"></div>
        <div ng-if="!matchClass && result.description && result.description != ''" class="angucomplete-description">{{result.description}}</div>
      </div>
      <div class="angucomplete-row" ng-click="selectResult({title: searchStr, originalObject: { name: searchStr, custom: true }})" ng-mouseenter="hoverRow(results.length)" ng-class="{'angucomplete-selected-row': results.length == currentIndex}">
        <div class="angucomplete-title">Select custom ingredient '{{ searchStr }}'</div>
      </div>
    </div>
  </div>
  </script>
-->
</div>

<script type="text/ng-template" id="/my-custom-template.html">
  <div class="angucomplete-holder" ng-class="{'angucomplete-dropdown-visible': showDropdown}">
    <input ng-model="searchStr"
    ng-disabled="disableInput"
    type="text"
    placeholder="{{placeholder}}"
    ng-focus="onFocusHandler()"
    class="{{inputClass}}"
    ng-focus="resetHideResults()"
    ng-blur="hideResults($event)"
    autocapitalize="off"
    autocorrect="off"
    autocomplete="off"
    ng-change="inputChangeHandler(searchStr);"/>
    <div class="angucomplete-dropdown" ng-show="showDropdown">
      <div class="angucomplete-searching" ng-show="searching" ng-bind="textSearching"></div>
      <div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults"></div>
      <div class="angucomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{'angucomplete-selected-row': $index == currentIndex}">
        <div ng-if="imageField" class="angucomplete-image-holder">
          <img ng-if="result.image && result.image != ''" ng-src="{{result.image}}" class="angucomplete-image"/>
          <div ng-if="!result.image && result.image != ''" class="angucomplete-image-default"></div>
        </div>
        <div class="angucomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div>
        <div class="angucomplete-title" ng-if="!matchClass">{{ result.title }}</div>
        <div ng-if="matchClass && result.description && result.description != ''" class="angucomplete-description" ng-bind-html="result.description"></div>
        <div ng-if="!matchClass && result.description && result.description != ''" class="angucomplete-description">{{result.description}}</div>
      </div>
      <div class="angucomplete-row" ng-click="selectResult({title: searchStr, originalObject: { name: searchStr, custom: true }})" ng-mouseenter="hoverRow(results.length)" ng-class="{'angucomplete-selected-row': results.length == currentIndex}">
        <div class="angucomplete-title">Select custom ingredient '{{ searchStr }}'</div>
      </div>
    </div>
  </div>
</script>
